<link rel="stylesheet" href="{{ url_for('static', filename='results.css') }}">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{{url_for('static', filename='js/results.js')}}"></script>
<script defer src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"
    integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc"
    crossorigin="anonymous"></script>
{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}

<div id="fb-root"></div>
<script async defer crossorigin="anonymous"
    src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0"></script>

<div class="resultbg">
    <div class="page-headerx">
        <div class="container">
            <div class="text">
                <span style="--i:-4">V</span>
                <span style="--i:-3">o</span>
                <span style="--i:-4">g</span>
                <span style="--i:-1">u</span>
                <span style="--i:0">e</span>
                <span style="--i:1">X</span>
            </div>
        </div>
        <div class="container flow">

            <div class="page-title">Tailor made, just for you.</div>
            <p class="page-subtitle"></p>
        </div>
    </div>

</div>
<div class="container">
    <p id="fav_msg" class="bg-success text-white text-center"></p>
</div>

<div style="display: flex; column-gap: 5px; margin-bottom: 10px; justify-content: center; margin-top: 30px;">
    <style>
        .queryDiv {
            background: #555;
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
        }
    </style>
    <script>
        // Show the query
        let query = JSON.parse(window.sessionStorage.getItem('query'));
        const queryKeys = ["culture", "occasion", "gender", "ageGroup", "seasonalTrends",
            "personalStyle", "bodyType", "fitType", "fabricPreference",
            "colorPreference", "clothingType", "activityType", "lowerBudget"];
        queryKeys.forEach(key => {
            if (query[key]) {
                if (key === "lowerBudget") {
                    let upperBudget = query["upperBudget"] ? query["upperBudget"] : "N/A";
                    document.write(`<div class="queryDiv">Budget Range: $${query[key]} - $${upperBudget}</div>`);
                    return;
                }
                document.write(`<div class="queryDiv">${query[key]}</div>`);
            }
        });
    </script>
</div>

<div style="margin-top: 50px; width: 100%; text-align: center; font-size: 20px; font-weight: 500;">Color Palettes</div>
<div style="width: 100%; text-align: center; font-size: 18px; font-weight: 300;">Some suggestions on what colors to wear
</div>
<div style="margin-top: 30px; margin-bottom: 60px; display: flex; justify-content: center; row-gap: 20px;"
    class="palettes">
</div>

<div class="" style="display: grid; grid-template-columns: 50% 50%; gap: 10px; padding-bottom: 100px;">
    {% for idx, link in enumerate(ldata) %}
    <div class="media-element">
        <img src={{ link }} alt="" id="Myimg{{idx}}">
        <div class="btn-group" role="group" aria-label="buttonGroup">
            <button id="show-img" type="button" class="blendbtn btn btn-primary rounded m-3" data-toggle="modal"
                data-target="#my-modal{{idx}}"><b>View</b></button>
            <a class="btn btn-primary buttonA rounded m-3" id="shop-link{{idx}}"
                href="/shopping-results?{{link}}"><b>Shop</b></a>
            <button id="favourite{{idx}}" type="button"
                class="blendbtn btn btn-primary favourite rounded m-3"><b>Favourite</b></button>

            <!-- <div class="fb-share-button" data-href={{link}} data-layout=""
                data-size="">
                <a target="_blank"
                    href="https://www.facebook.com/sharer/sharer.php?u={{ link }}&amp;src=sdkpreparse"
                    class="fb-xfbml-parse-ignore">Share</a>
            </div> -->

            <!-- create a button, that will give me a small dropdown list -->
            <div class="dropdown">
                <button class="btn btn-primary buttonA rounded m-3" type="button" id="shop-link{{idx}}"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Share
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">

                    <div class="dropdown-item">
                        <a class="dropdown-item"
                            href="https://www.facebook.com/sharer/sharer.php?u={{ link }}&t=CNN%26s+website;src=sdkpreparse"
                            target="_blank">

                            <img src="https://upload.wikimedia.org/wikipedia/en/0/04/Facebook_f_logo_%282021%29.svg"
                                alt="Twitter Logo" style="width: 20px; height: 20px; margin-right: 5px;">


                            Facebook</a>
                    </div>


                    <div class="dropdown-divider"></div>


                    <div class="dropdown-item" aria-labelledby="dropdownMenuButton">

                        <a class="dropdown-item"
                            href="https://twitter.com/intent/tweet?text=Check%20this%20out!&url={{ link }}"
                            target="_blank">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/c/ce/X_logo_2023.svg"
                                alt="Twitter Logo" style="width: 20px; height: 20px; margin-right: 5px;">
                            Twitter
                        </a>
                    </div>

                    <div class="dropdown-divider"></div>

                    <div class="dropdown-item" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item" href="https://t.me/share/url?url={{ link }}&text=Check%20this%20out!"
                            target="_blank">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg"
                                alt="Telegram Logo"
                                style="width: 20px; height: 20px; margin-right: 10px; vertical-align: middle;">
                            Telegram
                        </a>

                    </div>
                </div>
            </div>

            <!-- <button id="favourite{{idx}}" type="button"
                class="blendbtn btn btn-primary favourite rounded m-3"><b>Favourite</b></button> -->
        </div>
    </div>
    <div id="my-modal{{idx}}" class="modal fade" aria-labelledby="my-modalLabel" aria-hidden="true" tabindex="-1"
        role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src={{ link }} class="img-responsive" style="width: 100%;">
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
    function openFacebookPopup(link) {
        // Get current screen width and height
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;

        // Calculate the center position
        const popupWidth = 600;
        const popupHeight = 500;
        const left = (screenWidth - popupWidth) / 2 + window.scrollX;
        const top = (screenHeight - popupHeight) / 2 + window.scrollY;

        // Open the popup
        const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}&src=sdkpreparse`;
        window.open(url, 'fbShareWindow', `height=${popupHeight},width=${popupWidth},top=${top},left=${left},toolbar=no,menubar=no,resizable=yes,scrollbars=yes`);

        return false; // Prevent default link behavior
    }
</script>

<!-- <script>
    function openFacebookPopup(link) {
        // Get current scroll position
        const scrollX = window.screenX || window.screenLeft;
        const scrollY = window.screenY || window.screenTop;

        console.log(window.scrollX, window.scrollY);
        
        // Set popup dimensions
        const popupWidth = 600;
        const popupHeight = 500;

        // Open the popup at the current scroll position
        const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}&src=sdkpreparse`;
        window.open(url, 'fbShareWindow', `height=${popupHeight},width=${popupWidth},top=${scrollY + 100},left=${scrollX + 100},toolbar=no,menubar=no,resizable=yes,scrollbars=yes`);
        
        return false; // Prevent default link behavior
    }
</script> -->


{% endblock %}